<?xml version="1.0" encoding="utf-8"?><Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition"><Body><ReportItems><Tablix Name="Tablix1"><TablixBody><TablixColumns><TablixColumn><Width>5.52418cm</Width></TablixColumn><TablixColumn><Width>5.52418cm</Width></TablixColumn><TablixColumn><Width>5.52418cm</Width></TablixColumn><TablixColumn><Width>5.52418cm</Width></TablixColumn><TablixColumn><Width>5.52418cm</Width></TablixColumn><TablixColumn><Width>5.52418cm</Width></TablixColumn></TablixColumns><TablixRows><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="Textbox5"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>المستوى التنظيمي</Value><Style><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">Textbox5</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><BackgroundColor>LightGrey</BackgroundColor><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom><Direction>RTL</Direction></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox6"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>الفئة</Value><Style><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">Textbox6</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><BackgroundColor>LightGrey</BackgroundColor><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom><Direction>RTL</Direction></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox4"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>الوصف الوظيفي</Value><Style><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">Textbox4</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><BackgroundColor>LightGrey</BackgroundColor><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom><Direction>RTL</Direction></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox1"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>العقدة</Value><Style><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">Textbox1</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><BackgroundColor>LightGrey</BackgroundColor><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom><Direction>RTL</Direction></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox3"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>الاسم الكامل</Value><Style><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">Textbox3</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><BackgroundColor>LightGrey</BackgroundColor><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom><Direction>RTL</Direction></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="Textbox2"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>الرقم الذاتي للموظف</Value><Style><FontWeight>Bold</FontWeight></Style></TextRun></TextRuns><Style><TextAlign>Center</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">Textbox2</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><BackgroundColor>LightGrey</BackgroundColor><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom><Direction>RTL</Direction></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow><TablixRow><Height>0.6cm</Height><TablixCells><TablixCell><CellContents><Textbox Name="OrgLevelName"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!OrgLevelName.Value</Value><Style /></TextRun></TextRuns><Style><TextAlign>Right</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">OrgLevelName</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom><Direction>RTL</Direction></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="GradeName"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!GradeName.Value</Value><Style /></TextRun></TextRuns><Style><TextAlign>Right</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">GradeName</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom><Direction>RTL</Direction></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="JobDescriptionName"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!JobDescriptionName.Value</Value><Style /></TextRun></TextRuns><Style><TextAlign>Right</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">JobDescriptionName</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom><Direction>RTL</Direction></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="NodeName"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!NodeName.Value</Value><Style /></TextRun></TextRuns><Style><TextAlign>Right</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">NodeName</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom><Direction>RTL</Direction></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="FullName"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!FullName.Value</Value><Style /></TextRun></TextRuns><Style><TextAlign>Right</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">FullName</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom><Direction>RTL</Direction></Style></Textbox></CellContents></TablixCell><TablixCell><CellContents><Textbox Name="EmployeeCode"><CanGrow>true</CanGrow><KeepTogether>true</KeepTogether><Paragraphs><Paragraph><TextRuns><TextRun><Value>=Fields!EmployeeCode.Value</Value><Style /></TextRun></TextRuns><Style><TextAlign>Right</TextAlign></Style></Paragraph></Paragraphs><rd:DefaultName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">EmployeeCode</rd:DefaultName><Style><Border><Color>LightGrey</Color><Style>Solid</Style></Border><PaddingLeft>2pt</PaddingLeft><PaddingRight>2pt</PaddingRight><PaddingTop>2pt</PaddingTop><PaddingBottom>2pt</PaddingBottom><Direction>RTL</Direction></Style></Textbox></CellContents></TablixCell></TablixCells></TablixRow></TablixRows></TablixBody><TablixColumnHierarchy><TablixMembers><TablixMember /><TablixMember /><TablixMember /><TablixMember /><TablixMember /><TablixMember /></TablixMembers></TablixColumnHierarchy><TablixRowHierarchy><TablixMembers><TablixMember><KeepWithGroup>After</KeepWithGroup></TablixMember><TablixMember><Group Name="Details" /></TablixMember></TablixMembers></TablixRowHierarchy><DataSetName>BasicInfoDataSet</DataSetName><Top>0cm</Top><Left>0cm</Left><Height>1.2cm</Height><Width>33.14509cm</Width><Style><Border><Style>None</Style></Border></Style></Tablix></ReportItems><Height>0.47955in</Height><Style /></Body><Width>13.04925in</Width><Page><PageHeight>29.7cm</PageHeight><PageWidth>21cm</PageWidth><LeftMargin>2cm</LeftMargin><RightMargin>2cm</RightMargin><TopMargin>2cm</TopMargin><BottomMargin>2cm</BottomMargin><ColumnSpacing>0.13cm</ColumnSpacing><Style /></Page><AutoRefresh>0</AutoRefresh><DataSources><DataSource Name="DataSource"><DataSourceReference>SharedDataSource</DataSourceReference><rd:SecurityType xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">None</rd:SecurityType><rd:DataSourceID xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">9a350a56-51d6-40e0-b0cf-07e98984a2ce</rd:DataSourceID></DataSource></DataSources><DataSets><DataSet Name="BasicInfoDataSet"><Query><DataSourceName>DataSource</DataSourceName><CommandText>--Select 
--dbo.Employee.Id AS EmpId,
--dbo.Employee.FirstName+ ' '+ dbo.Employee.FatherName+' '+dbo.Employee.LastName AS FullName,
--N.Code AS EmployeeCode,

------ First get AttendanceForm From EmployeeCard 
------ if null get AttendanceForm From Grade
------ if null get AttendanceForm From GeneralSettings
----(
----	ISNULL 
----	(
----		dbo.EmployeeCard.AttendanceForm_id,
----		(ISNULL 
----			(
----				(SELECT  TOP 1   
----				dbo.Grade.AttendanceForm_id
----				FROM         
----				dbo.JobDescription INNER JOIN
----				dbo.JobTitle ON dbo.JobDescription.JobTitle_id = dbo.JobTitle.Id INNER JOIN
----				dbo.Grade ON dbo.JobTitle.Grade_id = dbo.Grade.Id
----				WHERE 
----				dbo.JobDescription.Id = N.JobDescription_id),
----				(SELECT AttendanceForm_id
----				FROM dbo.GeneralSettings)
----			)
----		)
----	)
----) 
---- AS AttendanceForm_id,
 
--N.JobDescription_id,
--(SELECT dbo.Node.Name FROM dbo.JobDescription INNER JOIN dbo.Node ON dbo.JobDescription.Node_id = dbo.Node.Id 
--WHERE dbo.JobDescription.Id=N.JobDescription_id AND Node.IsVertualDeleted = 0 AND JobDescription.IsVertualDeleted = 0)AS NodeName,
--(SELECT Name FROM dbo.JobDescription WHERE Id=N.JobDescription_id AND JobDescription.IsVertualDeleted = 0)AS JobDesName,
--(SELECT dbo.Grade.Name FROM dbo.JobDescription 
--INNER JOIN dbo.JobTitle ON dbo.JobDescription.JobTitle_id = dbo.JobTitle.Id 
--INNER JOIN dbo.Grade ON dbo.JobTitle.Grade_id = dbo.Grade.Id 
--WHERE dbo.JobDescription.Id=N.JobDescription_id AND JobTitle.IsVertualDeleted = 0 AND JobDescription.IsVertualDeleted = 0 AND Grade.IsVertualDeleted = 0
--) AS GradeName,
--(SELECT dbo.OrganizationalLevel.Name FROM dbo.JobDescription 
--INNER JOIN dbo.JobTitle ON dbo.JobDescription.JobTitle_id = dbo.JobTitle.Id 
--INNER JOIN dbo.Grade ON dbo.JobTitle.Grade_id = dbo.Grade.Id 
--INNER JOIN dbo.OrganizationalLevel ON dbo.Grade.OrganizationalLevel_id = dbo.OrganizationalLevel.Id 
--WHERE dbo.JobDescription.Id=N.JobDescription_id AND JobTitle.IsVertualDeleted = 0 AND JobDescription.IsVertualDeleted = 0 AND Grade.IsVertualDeleted = 0 AND OrganizationalLevel.IsVertualDeleted = 0)AS OrgLevelName
--from                     
--dbo.Employee INNER JOIN
--dbo.EmployeeCard ON dbo.Employee.Id = dbo.EmployeeCard.Employee_id INNER JOIN
--dbo.AssigningEmployeeToPosition ON dbo.Employee.Id = dbo.AssigningEmployeeToPosition.Employee_id INNER JOIN
--dbo.Position N ON dbo.AssigningEmployeeToPosition.Position_Id = N.Id AND 
--dbo.AssigningEmployeeToPosition.Id = N.AssigningEmployeeToPosition_id
--where CardStatus=1 AND Employee.IsVertualDeleted = 0 AND EmployeeCard.IsVertualDeleted = 0 AND AssigningEmployeeToPosition.IsVertualDeleted = 0 AND N.IsVertualDeleted = 0
--;

SELECT        
dbo.Employee.Id EmployeeId, 
dbo.Employee.FirstName +' '+ dbo.Employee.FatherName +' '+ dbo.Employee.LastName FullName,
dbo.Employee.Code AS EmployeeCode, 
dbo.Position.Code AS PositionCode,
Position.JobDescription_id,
-- First get AttendanceForm From EmployeeCard 
-- if null get AttendanceForm From Grade
-- if null get AttendanceForm From GeneralSettings
(
	ISNULL(dbo.EmployeeCard.AttendanceForm_id,(ISNULL((	SELECT	TOP 1 dbo.Grade.AttendanceForm_id 
														FROM	dbo.JobDescription 
														INNER JOIN dbo.JobTitle ON dbo.JobDescription.JobTitle_id = dbo.JobTitle.Id 
														INNER JOIN dbo.Grade ON dbo.JobTitle.Grade_id = dbo.Grade.Id
														WHERE	dbo.JobDescription.Id = Position.JobDescription_id),(SELECT top 1 AttendanceForm_id FROM dbo.GeneralSettings))))
) 
 AS AttendanceForm_id,
(SELECT dbo.Node.Name FROM dbo.JobDescription INNER JOIN dbo.Node ON dbo.JobDescription.Node_id = dbo.Node.Id 
WHERE dbo.JobDescription.Id=Position.JobDescription_id AND Node.IsVertualDeleted = 0 AND JobDescription.IsVertualDeleted = 0)AS NodeName,
(SELECT Name FROM dbo.JobDescription WHERE Id=Position.JobDescription_id AND JobDescription.IsVertualDeleted = 0)AS JobDescriptionName,
(SELECT dbo.Grade.Name FROM dbo.JobDescription 
INNER JOIN dbo.JobTitle ON dbo.JobDescription.JobTitle_id = dbo.JobTitle.Id 
INNER JOIN dbo.Grade ON dbo.JobTitle.Grade_id = dbo.Grade.Id 
WHERE dbo.JobDescription.Id=Position.JobDescription_id AND JobTitle.IsVertualDeleted = 0 AND JobDescription.IsVertualDeleted = 0 AND Grade.IsVertualDeleted = 0
) AS GradeName,
(SELECT dbo.OrganizationalLevel.Name FROM dbo.JobDescription 
INNER JOIN dbo.JobTitle ON dbo.JobDescription.JobTitle_id = dbo.JobTitle.Id 
INNER JOIN dbo.Grade ON dbo.JobTitle.Grade_id = dbo.Grade.Id 
INNER JOIN dbo.OrganizationalLevel ON dbo.Grade.OrganizationalLevel_id = dbo.OrganizationalLevel.Id 
WHERE dbo.JobDescription.Id=Position.JobDescription_id AND JobTitle.IsVertualDeleted = 0 AND JobDescription.IsVertualDeleted = 0 AND Grade.IsVertualDeleted = 0 AND OrganizationalLevel.IsVertualDeleted = 0)AS OrgLevelName
FROM
dbo.Employee 
INNER JOIN dbo.AssigningEmployeeToPosition ON dbo.Employee.Id = dbo.AssigningEmployeeToPosition.Employee_id 
INNER JOIN dbo.Position ON dbo.AssigningEmployeeToPosition.Position_Id = dbo.Position.Id 
INNER JOIN dbo.EmployeeCard ON dbo.Employee.Id = dbo.EmployeeCard.Employee_id 
WHERE        
dbo.EmployeeCard.CardStatus = 1 AND  
Employee.IsVertualDeleted=0 AND 
AssigningEmployeeToPosition.IsVertualDeleted=0 AND 
Position.IsVertualDeleted=0 AND 
EmployeeCard.IsVertualDeleted=0
ORDER BY FullName</CommandText></Query><Fields><Field Name="FullName"><DataField>FullName</DataField><rd:TypeName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">System.String</rd:TypeName></Field><Field Name="EmployeeCode"><DataField>EmployeeCode</DataField><rd:TypeName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">System.String</rd:TypeName></Field><Field Name="PositionCode"><DataField>PositionCode</DataField><rd:TypeName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">System.String</rd:TypeName></Field><Field Name="JobDescription_id"><DataField>JobDescription_id</DataField><rd:TypeName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">System.Int32</rd:TypeName></Field><Field Name="AttendanceForm_id"><DataField>AttendanceForm_id</DataField><rd:TypeName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">System.Int32</rd:TypeName></Field><Field Name="NodeName"><DataField>NodeName</DataField><rd:TypeName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">System.String</rd:TypeName></Field><Field Name="JobDescriptionName"><DataField>JobDescriptionName</DataField><rd:TypeName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">System.String</rd:TypeName></Field><Field Name="GradeName"><DataField>GradeName</DataField><rd:TypeName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">System.String</rd:TypeName></Field><Field Name="OrgLevelName"><DataField>OrgLevelName</DataField><rd:TypeName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">System.String</rd:TypeName></Field><Field Name="EmployeeId"><DataField>EmployeeId</DataField><rd:TypeName xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">System.Int32</rd:TypeName></Field></Fields><Filters><Filter><FilterExpression>=Fields!AttendanceForm_id.Value</FilterExpression><Operator>In</Operator><FilterValues><FilterValue>=Parameters!attendanceFormId.Value</FilterValue></FilterValues></Filter></Filters></DataSet></DataSets><ReportParameters><ReportParameter Name="attendanceFormId"><DataType>Integer</DataType><Prompt>ReportParameter1</Prompt><MultiValue>true</MultiValue></ReportParameter></ReportParameters><rd:ReportUnitType xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">Cm</rd:ReportUnitType><rd:ReportID xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">0ea7a57c-d865-429d-b149-0922ff15b21f</rd:ReportID></Report>