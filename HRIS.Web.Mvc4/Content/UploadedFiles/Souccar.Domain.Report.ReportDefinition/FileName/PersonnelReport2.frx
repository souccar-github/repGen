<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="12/29/2014 14:36:39" ReportInfo.Modified="11/13/2016 08:55:32" ReportInfo.CreatorVersion="0.0.0.0">
  <Dictionary>
    <MsSqlDataConnection Name="Connection" ConnectionString="rijcmlq+rW0RkboK+/8CKGGYUID3ctBV8q9SvKYxl3iiE7vBnh7Tgou0+4WFf3NfmPSvHVFlnkXqzD1VNqRCkSavrdXiIf+lj0vOFUlkMzi4+Olo92l+WuZ/TRneJ8XO81bLaaSB2QluU3h+Lwl6EM5c+0NgZ8NLhSO9QaUeH+VouE2ampuNgFmv8E1ty7Fg6f3tOq9">
      <TableDataSource Name="Table1" Alias="EmployeeNodeDataSourse" DataType="System.Int32" Enabled="true" SelectCommand="With listEmployee as(&#13;&#10;&#13;&#10;SELECT&#13;&#10;dbo.Node.Id AS NodeId, &#13;&#10;---------------------------female count---------------------------------------------------&#13;&#10;CASE WHEN dbo.Employee.Gender = 0 THEN&#13;&#10;(&#13;&#10;SELECT COUNT(distinct e2.Id) AS CountEmployeesOnHeadOfHisWork&#13;&#10;FROM   dbo.Employee AS e2 &#13;&#10;		INNER JOIN dbo.EmployeeCard ON e2.Id = dbo.EmployeeCard.Employee_id &#13;&#10;		INNER JOIN dbo.AssigningEmployeeToPosition ON e2.Id = dbo.AssigningEmployeeToPosition.Employee_id &#13;&#10;		INNER JOIN dbo.Position ON dbo.AssigningEmployeeToPosition.Position_Id = dbo.Position.Id&#13;&#10;		INNER JOIN dbo.JobDescription ON dbo.Position.JobDescription_id = dbo.JobDescription.Id&#13;&#10;WHERE        &#13;&#10;dbo.EmployeeCard.CardStatus = 1 AND  &#13;&#10;dbo.AssigningEmployeeToPosition.IsPrimary='True' AND &#13;&#10;Employee.IsVertualDeleted=0 AND &#13;&#10;AssigningEmployeeToPosition.IsVertualDeleted=0 AND &#13;&#10;Position.IsVertualDeleted=0 AND &#13;&#10;JobDescription.IsVertualDeleted=0 AND &#13;&#10;EmployeeCard.IsVertualDeleted=0 AND dbo.JobDescription.Node_id=dbo.Node.Id AND e2.Gender=dbo.Employee.Gender) ELSE 0 END AS FemaleCount,&#13;&#10;---------------------------Meal count---------------------------------------------------&#13;&#10;CASE WHEN dbo.Employee.Gender = 1 THEN&#13;&#10;(&#13;&#10;SELECT COUNT(distinct e2.Id) AS CountEmployeesOnHeadOfHisWork&#13;&#10;FROM dbo.Employee AS e2 &#13;&#10;	INNER JOIN dbo.EmployeeCard ON e2.Id = dbo.EmployeeCard.Employee_id &#13;&#10;	INNER JOIN dbo.AssigningEmployeeToPosition ON e2.Id = dbo.AssigningEmployeeToPosition.Employee_id &#13;&#10;	INNER JOIN dbo.Position ON dbo.AssigningEmployeeToPosition.Position_Id = dbo.Position.Id&#13;&#10;	INNER JOIN dbo.JobDescription ON dbo.Position.JobDescription_id = dbo.JobDescription.Id&#13;&#10;WHERE        &#13;&#10;dbo.EmployeeCard.CardStatus = 1 AND  &#13;&#10;dbo.AssigningEmployeeToPosition.IsPrimary='True' AND &#13;&#10;Employee.IsVertualDeleted=0 AND &#13;&#10;AssigningEmployeeToPosition.IsVertualDeleted=0 AND &#13;&#10;Position.IsVertualDeleted=0 AND &#13;&#10;JobDescription.IsVertualDeleted=0 AND &#13;&#10;EmployeeCard.IsVertualDeleted=0 AND dbo.JobDescription.Node_id=dbo.Node.Id AND e2.Gender=dbo.Employee.Gender) ELSE 0 END AS MaleCount,&#13;&#10;---------------------------All count---------------------------------------------------&#13;&#10;(SELECT COUNT(distinct e2.Id) AS CountEmployeesOnHeadOfHisWork&#13;&#10;FROM	dbo.Employee AS e2 &#13;&#10;		INNER JOIN dbo.EmployeeCard ON e2.Id = dbo.EmployeeCard.Employee_id &#13;&#10;		INNER JOIN dbo.AssigningEmployeeToPosition ON e2.Id = dbo.AssigningEmployeeToPosition.Employee_id &#13;&#10;		INNER JOIN dbo.Position ON dbo.AssigningEmployeeToPosition.Position_Id = dbo.Position.Id&#13;&#10;		INNER JOIN dbo.JobDescription ON dbo.Position.JobDescription_id = dbo.JobDescription.Id&#13;&#10;WHERE        &#13;&#10;dbo.EmployeeCard.CardStatus = 1 AND  &#13;&#10;dbo.AssigningEmployeeToPosition.IsPrimary='True' AND &#13;&#10;Employee.IsVertualDeleted=0 AND &#13;&#10;AssigningEmployeeToPosition.IsVertualDeleted=0 AND &#13;&#10;Position.IsVertualDeleted=0 AND &#13;&#10;JobDescription.IsVertualDeleted=0 AND &#13;&#10;EmployeeCard.IsVertualDeleted=0 AND dbo.JobDescription.Node_id=dbo.Node.Id) AS AllCount,&#13;&#10;---------------------------female Percentage---------------------------------------------------&#13;&#10;CASE WHEN dbo.Employee.Gender = 0 THEN&#13;&#10;round(cast((100/cast((&#13;&#10;SELECT	COUNT(distinct e2.Id) AS CountEmployeesOnHeadOfHisWork&#13;&#10;FROM	dbo.Employee AS e2 &#13;&#10;		INNER JOIN dbo.EmployeeCard ON e2.Id = dbo.EmployeeCard.Employee_id &#13;&#10;		INNER JOIN dbo.AssigningEmployeeToPosition ON e2.Id = dbo.AssigningEmployeeToPosition.Employee_id &#13;&#10;		INNER JOIN dbo.Position ON dbo.AssigningEmployeeToPosition.Position_Id = dbo.Position.Id &#13;&#10;		INNER JOIN dbo.JobDescription ON dbo.Position.JobDescription_id = dbo.JobDescription.Id&#13;&#10;WHERE        &#13;&#10;dbo.EmployeeCard.CardStatus = 1 AND  &#13;&#10;dbo.AssigningEmployeeToPosition.IsPrimary='True' AND &#13;&#10;Employee.IsVertualDeleted=0 AND &#13;&#10;AssigningEmployeeToPosition.IsVertualDeleted=0 AND &#13;&#10;Position.IsVertualDeleted=0 AND &#13;&#10;JobDescription.IsVertualDeleted=0 AND &#13;&#10;EmployeeCard.IsVertualDeleted=0 AND dbo.JobDescription.Node_id=dbo.Node.Id) AS float)) as float)&#13;&#10;*(SELECT	COUNT(distinct e2.Id) AS CountEmployeesOnHeadOfHisWork&#13;&#10;FROM	dbo.Employee AS e2 &#13;&#10;		INNER JOIN dbo.EmployeeCard ON e2.Id = dbo.EmployeeCard.Employee_id &#13;&#10;		INNER JOIN dbo.AssigningEmployeeToPosition ON e2.Id = dbo.AssigningEmployeeToPosition.Employee_id &#13;&#10;		INNER JOIN dbo.Position ON dbo.AssigningEmployeeToPosition.Position_Id = dbo.Position.Id&#13;&#10;		INNER JOIN dbo.JobDescription ON dbo.Position.JobDescription_id = dbo.JobDescription.Id&#13;&#10;WHERE        &#13;&#10;dbo.EmployeeCard.CardStatus = 1 AND  &#13;&#10;dbo.AssigningEmployeeToPosition.IsPrimary='True' AND &#13;&#10;Employee.IsVertualDeleted=0 AND &#13;&#10;AssigningEmployeeToPosition.IsVertualDeleted=0 AND &#13;&#10;Position.IsVertualDeleted=0 AND &#13;&#10;JobDescription.IsVertualDeleted=0 AND &#13;&#10;EmployeeCard.IsVertualDeleted=0 AND dbo.JobDescription.Node_id=dbo.Node.Id AND e2.Gender=dbo.Employee.Gender),2)&#13;&#10;ELSE 0 END AS FemalePercentage,&#13;&#10;---------------------------Male Percentage---------------------------------------------------&#13;&#10;CASE WHEN dbo.Employee.Gender = 1 THEN&#13;&#10;round(cast((100/cast((&#13;&#10;SELECT	COUNT(distinct e2.Id) AS CountEmployeesOnHeadOfHisWork&#13;&#10;FROM	dbo.Employee AS e2 &#13;&#10;		INNER JOIN dbo.EmployeeCard ON e2.Id = dbo.EmployeeCard.Employee_id &#13;&#10;		INNER JOIN dbo.AssigningEmployeeToPosition ON e2.Id = dbo.AssigningEmployeeToPosition.Employee_id &#13;&#10;		INNER JOIN dbo.Position ON dbo.AssigningEmployeeToPosition.Position_Id = dbo.Position.Id&#13;&#10;		INNER JOIN dbo.JobDescription ON dbo.Position.JobDescription_id = dbo.JobDescription.Id&#13;&#10;WHERE        &#13;&#10;dbo.EmployeeCard.CardStatus = 1 AND  &#13;&#10;dbo.AssigningEmployeeToPosition.IsPrimary='True' AND &#13;&#10;Employee.IsVertualDeleted=0 AND &#13;&#10;AssigningEmployeeToPosition.IsVertualDeleted=0 AND &#13;&#10;Position.IsVertualDeleted=0 AND &#13;&#10;JobDescription.IsVertualDeleted=0 AND &#13;&#10;EmployeeCard.IsVertualDeleted=0 AND dbo.JobDescription.Node_id=dbo.Node.Id) as float)) AS float)&#13;&#10;*&#13;&#10;(SELECT	COUNT(distinct e2.Id) AS CountEmployeesOnHeadOfHisWork&#13;&#10;FROM	dbo.Employee AS e2 &#13;&#10;		INNER JOIN dbo.EmployeeCard ON e2.Id = dbo.EmployeeCard.Employee_id &#13;&#10;		INNER JOIN dbo.AssigningEmployeeToPosition ON e2.Id = dbo.AssigningEmployeeToPosition.Employee_id &#13;&#10;		INNER JOIN dbo.Position ON dbo.AssigningEmployeeToPosition.Position_Id = dbo.Position.Id&#13;&#10;		INNER JOIN dbo.JobDescription ON dbo.Position.JobDescription_id = dbo.JobDescription.Id&#13;&#10;WHERE        &#13;&#10;dbo.EmployeeCard.CardStatus = 1 AND  &#13;&#10;dbo.AssigningEmployeeToPosition.IsPrimary='True' AND &#13;&#10;Employee.IsVertualDeleted=0 AND &#13;&#10;AssigningEmployeeToPosition.IsVertualDeleted=0 AND &#13;&#10;Position.IsVertualDeleted=0 AND &#13;&#10;JobDescription.IsVertualDeleted=0 AND &#13;&#10;EmployeeCard.IsVertualDeleted=0 AND dbo.JobDescription.Node_id=dbo.Node.Id AND e2.Gender=dbo.Employee.Gender),2)&#13;&#10;ELSE 0 END AS MalePercentage&#13;&#10;---------------------------------------------------------------------------------------&#13;&#10;&#13;&#10;FROM	dbo.Employee &#13;&#10;		INNER JOIN dbo.EmployeeCard ON dbo.Employee.Id = dbo.EmployeeCard.Employee_id &#13;&#10;		INNER JOIN dbo.AssigningEmployeeToPosition ON dbo.Employee.Id = dbo.AssigningEmployeeToPosition.Employee_id &#13;&#10;		INNER JOIN dbo.Position ON dbo.AssigningEmployeeToPosition.Position_Id = dbo.Position.Id&#13;&#10;		INNER JOIN dbo.JobDescription ON dbo.Position.JobDescription_id = dbo.JobDescription.Id &#13;&#10;		INNER JOIN dbo.Node ON dbo.JobDescription.Node_id = dbo.Node.Id&#13;&#10;WHERE        &#13;&#10;dbo.EmployeeCard.CardStatus = 1 AND  &#13;&#10;dbo.AssigningEmployeeToPosition.IsPrimary='True' AND &#13;&#10;Employee.IsVertualDeleted=0 AND &#13;&#10;AssigningEmployeeToPosition.IsVertualDeleted=0 AND &#13;&#10;Position.IsVertualDeleted=0 AND &#13;&#10;JobDescription.IsVertualDeleted=0 AND &#13;&#10;EmployeeCard.IsVertualDeleted=0 AND&#13;&#10;Node.IsVertualDeleted=0 &#13;&#10;)&#13;&#10;SELECT &#13;&#10;NodeId,&#13;&#10;(SELECT Name FROM dbo.Node WHERE Id=NodeId) AS NodeName,&#13;&#10;MAX(FemaleCount) AS FemaleCount,&#13;&#10;MAX(MaleCount) AS MaleCount,&#13;&#10;MAX(AllCount) AS AllCount,&#13;&#10;MAX(FemalePercentage) AS FemalePercentage,&#13;&#10;MAX(MalePercentage) AS MalePercentage&#13;&#10;FROM listEmployee&#13;&#10;GROUP BY NodeId">
        <Column Name="NodeId" DataType="System.Int32"/>
        <Column Name="NodeName" DataType="System.String"/>
        <Column Name="FemaleCount" DataType="System.Int32"/>
        <Column Name="MaleCount" DataType="System.Int32"/>
        <Column Name="AllCount" DataType="System.Int32"/>
        <Column Name="FemalePercentage" DataType="System.Int32"/>
        <Column Name="MalePercentage" DataType="System.Int32"/>
      </TableDataSource>
    </MsSqlDataConnection>
    <Total Name="TotalCount" TotalType="Count" Expression="[EmployeeNodeDataSourse.MaleCount]" Evaluator="Data1"/>
  </Dictionary>
  <ReportPage Name="Page1">
    <ReportTitleBand Name="ReportTitle1" Width="718.2" Height="75.6">
      <TextObject Name="Text15" Top="18.9" Width="718.2" Height="37.8" Fill.Color="WhiteSmoke" Text="تقرير توزع الإناث والذكور حسب الاقسام" HorzAlign="Center" VertAlign="Center" RightToLeft="true" Font="Tahoma, 14pt, style=Bold"/>
      <TextObject Name="Text11" Width="75.6" Height="18.9" Text="[Date]" Format="Date" Format.Format="d" HorzAlign="Center" VertAlign="Center" RightToLeft="true" Font="Tahoma, 8pt"/>
    </ReportTitleBand>
    <PageHeaderBand Name="PageHeader1" Top="79.6" Width="718.2" Height="18.9">
      <TextObject Name="Text29" Left="236.25" Width="94.5" Height="18.9" Border.Lines="All" Border.Color="Silver" Fill.Color="WhiteSmoke" Text="عدد الإناث" HorzAlign="Center" RightToLeft="true" Font="Arial, 12pt, style=Bold"/>
      <TextObject Name="Text30" Left="425.25" Width="292.95" Height="18.9" Border.Lines="All" Border.Color="Silver" Fill.Color="WhiteSmoke" Text="اسم العقدة" HorzAlign="Center" RightToLeft="true" Font="Arial, 12pt, style=Bold"/>
      <TextObject Name="Text31" Left="330.75" Width="94.5" Height="18.9" Border.Lines="All" Border.Color="Silver" Fill.Color="WhiteSmoke" Text="عدد الذكور" HorzAlign="Center" RightToLeft="true" Font="Arial, 12pt, style=Bold"/>
      <TextObject Name="Text35" Width="141.75" Height="18.9" Border.Lines="All" Border.Color="Silver" Fill.Color="WhiteSmoke" Text="نسبة الإناث" HorzAlign="Center" RightToLeft="true" Font="Arial, 12pt, style=Bold"/>
      <TextObject Name="Text36" Left="141.75" Width="94.5" Height="18.9" Border.Lines="All" Border.Color="Silver" Fill.Color="WhiteSmoke" Text="نسبة الذكور" HorzAlign="Center" RightToLeft="true" Font="Arial, 12pt, style=Bold"/>
    </PageHeaderBand>
    <DataBand Name="Data1" Top="102.5" Width="718.2" Height="37.8" CanGrow="true" CanBreak="true" DataSource="Table1">
      <TextObject Name="Text1" Width="141.75" Height="37.8" Border.Lines="All" Border.Color="LightGray" CanGrow="true" GrowToBottom="true" Text="[EmployeeNodeDataSourse.FemalePercentage]" HorzAlign="Center" VertAlign="Center" RightToLeft="true" Font="Tahoma, 8pt"/>
      <TextObject Name="Text2" Left="141.75" Width="94.5" Height="37.8" Border.Lines="All" Border.Color="LightGray" CanGrow="true" GrowToBottom="true" Text="[EmployeeNodeDataSourse.MalePercentage]" HorzAlign="Center" VertAlign="Center" RightToLeft="true" Font="Tahoma, 8pt"/>
      <TextObject Name="Text3" Left="330.75" Width="94.5" Height="37.8" Border.Lines="All" Border.Color="LightGray" CanGrow="true" GrowToBottom="true" Text="[EmployeeNodeDataSourse.MaleCount]" HorzAlign="Center" VertAlign="Center" RightToLeft="true" Font="Tahoma, 8pt"/>
      <TextObject Name="Text5" Left="236.25" Width="94.5" Height="37.8" Border.Lines="All" Border.Color="LightGray" CanGrow="true" GrowToBottom="true" Text="[EmployeeNodeDataSourse.FemaleCount]" HorzAlign="Center" VertAlign="Center" RightToLeft="true" Font="Tahoma, 8pt"/>
      <TextObject Name="Text4" Left="425.25" Width="292.95" Height="37.8" Border.Lines="All" Border.Color="LightGray" CanGrow="true" GrowToBottom="true" Text="[EmployeeNodeDataSourse.NodeName]" HorzAlign="Center" VertAlign="Center" RightToLeft="true" Font="Tahoma, 8pt"/>
      <DataFooterBand Name="DataFooter1" Top="144.3" Width="718.2" Height="18.9">
        <TextObject Name="Text38" Left="425.25" Width="292.95" Height="18.9" Border.Lines="All" Border.Color="Silver" Fill.Color="WhiteSmoke" Text="عدد الأسطر" HorzAlign="Center" RightToLeft="true" Font="Arial, 12pt, style=Bold"/>
        <TextObject Name="Text6" Left="330.75" Width="94.5" Height="18.9" Border.Lines="Top, Bottom" Border.Color="LightGray" Fill.Color="WhiteSmoke" Text="[TotalCount]" HorzAlign="Center" VertAlign="Center" RightToLeft="true" Font="Tahoma, 8pt, style=Bold"/>
        <TextObject Name="Text39" Width="330.75" Height="18.9" Border.Lines="Left, Top, Bottom" Border.Color="LightGray" Fill.Color="WhiteSmoke" HorzAlign="Center" VertAlign="Center" RightToLeft="true" Font="Tahoma, 8pt, style=Bold"/>
      </DataFooterBand>
    </DataBand>
    <PageFooterBand Name="PageFooter1" Top="167.2" Width="718.2" Height="28.35">
      <TextObject Name="Text8" Left="642.6" Top="9.45" Width="75.6" Height="18.9" Text="[Page]الصفحة" HorzAlign="Right" RightToLeft="true" Font="Tahoma, 8pt"/>
    </PageFooterBand>
  </ReportPage>
</Report>
